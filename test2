import networkx as nx
import matplotlib.pyplot as plt
import json

# ğŸ“Œ Charger le fichier GeoJSON
geojson_file = r"C:\Users\anwar\Documents\GitHub\plancampus\batgeojson\routes_Universites.geojson"  # Remplace par ton fichier
with open(geojson_file, "r", encoding="utf-8") as f:
    data = json.load(f)

# ğŸ“Œ VÃ©rifier la structure
print("ğŸ” ClÃ©s principales :", data.keys())
print("ğŸ” Nombre de features :", len(data["features"]))

# ğŸ“Œ Afficher un exemple
print(json.dumps(data["features"][0], indent=2))  # Exemple d'un Ã©lÃ©ment



# ğŸ“Œ Initialiser un graphe

G = nx.Graph()

# ğŸ“Œ Parcourir chaque feature GeoJSON
for feature in data["features"]:
    if feature["geometry"]["type"] == "LineString":  # VÃ©rifier que c'est une route
        coords = feature["geometry"]["coordinates"]
        
        # ğŸ“Œ Ajouter les nÅ“uds et arÃªtes
        for i in range(len(coords) - 1):
            node1 = tuple(coords[i])
            node2 = tuple(coords[i + 1])

            # ğŸ“Œ Ajouter les nÅ“uds au graphe
            G.add_node(node1, pos=node1)
            G.add_node(node2, pos=node2)

            # ğŸ“Œ Ajouter l'arÃªte (distance = poids)
            dist = ((node1[0] - node2[0])**2 + (node1[1] - node2[1])**2) ** 0.5
            G.add_edge(node1, node2, weight=dist)

print("âœ… Graphe crÃ©Ã© avec", len(G.nodes), "nÅ“uds et", len(G.edges), "arÃªtes.")


# ğŸ“Œ RÃ©cupÃ©rer les positions des nÅ“uds
pos = nx.get_node_attributes(G, "pos")

# ğŸ“Œ Afficher le graphe
plt.figure(figsize=(10, 10))
nx.draw(G, pos, node_size=10, with_labels=False, edge_color="blue")
plt.show()
